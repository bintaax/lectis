{% extends 'base.html.twig' %}

{% block title %}Catalogue{% endblock %}

{% block body %}

<!-- MESSAGE DE BIENVENUE -->
{% if app.user %}
    <p class="text-gray-700 mt-10 text-xl md:text-2xl text-center px-6">
        üëã Bienvenue, 
        <span class="font-bold">{{ app.user.prenom ?? app.user.email }}</span> !
    </p>
{% endif %}

<!-- CATALOGUE PAR GENRE -->
{% for genre, livres in livresParGenre %}

    {% set genreId = genre|lower|replace({' ':'-'}) %}

    <section class="px-6 md:px-12 py-16">

        <h2 class="text-3xl md:text-4xl font-bold text-bluegray-dark mb-6">
            {{ genre }}
        </h2>

        <div class="relative">

            <!-- Bouton gauche -->
            <button 
                class="absolute left-0 top-1/2 -translate-y-1/2 z-10 
                       bg-white/80 hover:bg-white shadow p-2 rounded-full hidden sm:block"
                onclick="scrollLeft('{{ genreId }}')">
                ‚Üê
            </button>

            <!-- CONTENEUR SCROLLABLE -->
            <div id="{{ genreId }}" 
                 class="flex gap-6 overflow-x-auto scroll-smooth py-4 px-2 no-scrollbar">

                {% for livre in livres %}

                    <div class=" bg-white p-4 border border-default shadow-xs 
                                rounded-xl 
                                min-w-[160px] sm:min-w-[200px] md:min-w-[220px] lg:min-w-[240px]">

                        <!-- IMAGE COUVERTURE RESPONSIVE -->
                        <a href="{{ path('app_detail', { slug: livre.slug }) }}">
                            <div class="w-full h-[220px] sm:h-[260px] md:h-[300px] lg:h-[320px] 
                                        overflow-hidden rounded-lg bg-white">
                                <img 
                                    class="w-full h-full object-cover" 
                                    src="/assets/img/{{ livre.photo }}" 
                                    alt="{{ livre.titre }}"
                                />
                            </div>
                        </a>

                        <!-- TITRE -->
                        <a href="{{ path('app_detail', { slug: livre.slug }) }}">
                            <p class="mt-4 mb-1 text-sm sm:text-base md:text-lg font-semibold text-heading line-clamp-2">
                                {{ livre.titre }}
                            </p>
                        </a>

                        <!-- AUTEUR -->
                        <p class="mb-2 text-body text-xs sm:text-sm truncate">
                            {{ livre.auteur }}
                        </p>

                        <!-- PRIX -->
                        <p class="mb-2 text-body text-lg sm:text-xl font-semibold">
                            {{ livre.prix }} ‚Ç¨
                        </p>

                        <!-- DISPONIBILIT√â -->
                        <div class="mb-3">
                            {{ livre.getDisponibiliteBadge()|raw }}
                        </div>

                        <!-- BOUTON D√âTAIL -->
                        <button class="hover:bg-[#293a49]"><a href="{{ path('app_detail', { slug: livre.slug }) }}"
                           class=" text-white">
                            Voir le d√©tail
                            <i class="fa-solid fa-arrow-down fa-rotate-270 ml-2"></i>
                        </a></button>

                    </div>

                {% endfor %}

            </div>

            <!-- Bouton droite -->
            <button 
                class="absolute right-0 top-1/2 -translate-y-1/2 z-10 
                       bg-white/80 hover:bg-white shadow p-2 rounded-full hidden sm:block"
                onclick="scrollRight('{{ genreId }}')">
                ‚Üí
            </button>

        </div>

    </section>

{% endfor %}

{% endblock %}
